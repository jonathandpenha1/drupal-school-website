/* @license GNU-GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function($,Drupal,drupalSettings,once){'use strict';Drupal.behaviors.webformElementStates={attach:function(context){$(once('webform-element-states-condition','.webform-states-table--condition',context)).each(function(){var $condition=$(this);var $selector=$condition.find('.webform-states-table--selector select');var $value=$condition.find('.webform-states-table--value input');var $trigger=$condition.find('.webform-states-table--trigger select');$value.autocomplete({minLength:0}).on('focus',function(){$value.autocomplete('search','');});$trigger.on('change',function(){$selector.trigger('change');});$selector.on('change',function(){var selector=$selector.val();var sourceKey=drupalSettings.webformElementStates.selectors[selector];var source=drupalSettings.webformElementStates.sources[sourceKey];var notPattern=($trigger.val().indexOf('pattern')===-1);if(source&&notPattern)$value.autocomplete('option','source',source).addClass('form-autocomplete');else $value.autocomplete('option','source',[]).removeClass('form-autocomplete');var off=/chrom(e|ium)/.test(window.navigator.userAgent.toLowerCase())?'chrome-off-'+Math.floor(Math.random()*100000000):'off';$value.attr('autocomplete',off);}).trigger('change');});var $state=$(context).find('.webform-states-table--state select');if($state.length){$(once('webform-element-states-state',$state)).on('change',toggleRequiredCheckbox);toggleRequiredCheckbox();}}};var requiredChecked=null;function toggleRequiredCheckbox(){var $input=$('input[name="properties[required]"]');if(!$input.length)return;var required=false;$('.webform-states-table--state select').each(function(){var value=$(this).val();if(value==='required'||value==='optional')required=true;});if(required){requiredChecked=$input.prop('checked');$input.attr('disabled',true);$input.prop('checked',true);}else{$input.attr('disabled',false);if(requiredChecked!==null){$input.prop('checked',requiredChecked);requiredChecked=null;}}$input.trigger('change');}})(jQuery,Drupal,drupalSettings,once);;
(function($,Drupal){"use strict";Drupal.behaviors.imceUrlInput={attach:function(context,settings){$('.imce-url-input',context).not('.imce-url-processed').addClass('imce-url-processed').each(imceInput.processUrlInput);}};var imceInput=window.imceInput=window.imceInput||{processUrlInput:function(i,el){var button=imceInput.createUrlButton(el.id,el.getAttribute('data-imce-type'));el.parentNode.insertBefore(button,el);},createUrlButton:function(inputId,inputType){var button=document.createElement('a');button.href='#';button.className='imce-url-button';button.title=Drupal.t('Open File Browser');button.innerHTML='<span>'+button.title+'</span>';button.onclick=imceInput.urlButtonClick;button.setAttribute('data-input-id',inputId||'imce-url-input-'+(Math.random()+'').substring(2));button.setAttribute('data-input-type',inputType||'link');return button;},urlButtonClick:function(e){const inputId=this.getAttribute('data-input-id');const type=this.getAttribute('data-input-type');$('#'+inputId).trigger('focus');imceInput.openImce('imceInput.urlSendto',type,'inputId='+inputId);return false;},openImce:function(sendto,type,params){var url=imceInput.url('sendto='+sendto+'&type='+type+(params?'&'+params:''));return imceInput.openWindow(url);},url:function(params){var url=Drupal.url('imce');if(params)url+=(url.indexOf('?')===-1?'?':'&')+params;return url;},openWindow:function(url,win){var width=Math.min(1000,parseInt(screen.availWidth*0.8));var height=Math.min(800,parseInt(screen.availHeight*0.8));return (win||window).open(url,'','width='+width+',height='+height+',resizable=1');},urlSendto:function(File,win){var url=File.getUrl();var el=$('#'+win.imce.getQuery('inputId'))[0];win.close();if(el)$(el).val(url).trigger('change').trigger('focus');}};})(jQuery,Drupal);;
(function($,Drupal){'use strict';window.imceInput.processUrlInput=function(i,el){var button=imceInput.createUrlButton(el.id,el.getAttribute('data-imce-type'));$(button).insertAfter($(el));};})(jQuery,Drupal);;
(function($,Drupal,once){'use strict';Drupal.behaviors.webformOptionsAdmin={attach:function(context){$(once('webform-options-sync','.js-webform-options-sync',context)).each(function(){var name=this.name;var $value=$(this);var $text=$('input[name="'+name.replace(/\[value\]$/,'[text]')+'"]');$value.on('focus',function(){var sync=$value.val()===$text.val();$value.data('webform_options_sync',sync);if(sync)$text.prop('readonly',true).closest('.js-form-item, .js-form-wrapper').addClass('webform-readonly');});$value.on('blur',function(){if($value.data('webform_options_sync'))$text.prop('readonly',false).closest('.js-form-item, .js-form-wrapper').removeClass('webform-readonly');});$value.on('keyup',function(){if($value.data('webform_options_sync'))$text.val($value.val());});});}};})(jQuery,Drupal,once);;
(function($,Drupal,once){'use strict';Drupal.behaviors.webformMultipleTableDrag={attach:function(context,settings){for(var base in settings.tableDrag)if(settings.tableDrag.hasOwnProperty(base))$(once('webform-multiple-table-drag','.js-form-type-webform-multiple #'+base,context)).each(function(){var $tableDrag=$(this);var $toggleWeight=$tableDrag.prev().prev('.tabledrag-toggle-weight-wrapper');if($toggleWeight.length){$toggleWeight.addClass('webform-multiple-tabledrag-toggle-weight');$tableDrag.after($toggleWeight);}});}};Drupal.behaviors.webformMultipleAdd={attach:function(context,settings){$(once('webform-multiple-add','.js-webform-multiple-add',context)).each(function(){var $submit=$(this).find('input[type="submit"], button');var $number=$(this).find('input[type="number"]');$number.keyup(function(event){if(event.which===13)$submit.trigger('mousedown');});});}};})(jQuery,Drupal,once);;
(function($,Drupal,drupalSettings){Drupal.behaviors.machineName={attach(context,settings){const self=this;const $context=$(context);let timeout=null;let xhr=null;function clickEditHandler(e){const data=e.data;data.$wrapper.removeClass('hidden');if(data.$target.attr('data-machine-name-require-when-visible'))data.$target.attr('required',true).removeAttr('data-machine-name-require-when-visible');data.$target.trigger('focus');data.$suffix.hide();data.$source.off('.machineName');}function machineNameHandler(e){const data=e.data;const options=data.options;const baseValue=e.target.value;const rx=new RegExp(options.replace_pattern,'g');const expected=baseValue.toLowerCase().replace(rx,options.replace).substr(0,options.maxlength);if(xhr&&xhr.readystate!==4){xhr.abort();xhr=null;}if(timeout){clearTimeout(timeout);timeout=null;}if(baseValue.toLowerCase()!==expected)timeout=setTimeout(()=>{xhr=self.transliterate(baseValue,options).done((machine)=>{self.showMachineName(machine.substr(0,options.maxlength),data);});},300);else self.showMachineName(expected,data);}Object.keys(settings.machineName).forEach((sourceId)=>{const options=settings.machineName[sourceId];const $source=$(once('machine-name',$context.find(sourceId).addClass('machine-name-source')));const $target=$context.find(options.target).addClass('machine-name-target');const $suffix=$context.find(options.suffix);const $wrapper=$target.closest('.js-form-item');if(!$source.length||!$target.length||!$suffix.length||!$wrapper.length)return;if($target.hasClass('error')&&$target[0].value&&$target[0].value.trim().length)return;options.maxlength=$target.attr('maxlength');$wrapper.addClass('hidden');if($target.attr('required'))$target.removeAttr('required').attr('data-machine-name-require-when-visible');const machine=$target[0].value;const $preview=$(`<span class="machine-name-value">${options.field_prefix}${Drupal.checkPlain(machine)}${options.field_suffix}</span>`);$suffix.empty();if(options.label)$suffix.append(`<span class="machine-name-label">${options.label}: </span>`);$suffix.append($preview);if($target.is(':disabled'))return;const eventData={$source,$target,$suffix,$wrapper,$preview,options};if(machine===''&&$source[0].value!=='')self.transliterate($source[0].value,options).done((machineName)=>{self.showMachineName(machineName.substr(0,options.maxlength),eventData);});const $link=$('<span class="admin-link"><button type="button" class="link" aria-label="'.concat(Drupal.t('Edit machine name'),'">').concat(Drupal.t('Edit'),'</button></span>')).on('click',eventData,clickEditHandler);$suffix.append($link);if($target[0].value==='')$source.on('formUpdated.machineName',eventData,machineNameHandler).trigger('formUpdated.machineName');});},showMachineName(machine,data){const settings=data.options;if(machine!==''){if(machine!==settings.replace){data.$target[0].value=machine;data.$preview.html(settings.field_prefix+Drupal.checkPlain(machine)+settings.field_suffix);}data.$suffix.show();}else{data.$suffix.hide();data.$target[0].value=machine;data.$preview.empty();}},transliterate(source,settings){return $.get(Drupal.url('machine_name/transliterate'),{text:source,langcode:drupalSettings.langcode,replace_pattern:settings.replace_pattern,replace_token:settings.replace_token,replace:settings.replace,lowercase:true});}};})(jQuery,Drupal,drupalSettings);;
